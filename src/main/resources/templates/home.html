<!DOCTYPE HTML>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>


    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">

    <meta charset="utf-8" />
    <style>
        html{
            width: 100%;
            height: 100%;
        }
        body {

            width: 100%;
            height: 100%;
            margin:  0;
            background-color: black;
            background-repeat: no-repeat;
            background-attachment: fixed;


        }
        #main{
            margin: 0 auto;
            width:  100%;
            height: 100%;
            background-image: url("logo.png");
            background-repeat: no-repeat;
            background-position: center left;
            background-size:contain;
            background-attachment: fixed;
        }
    </style>


</head>
<body>


<div id="main">
    <div style="width:100%; height: 40%; text-align:center; margin-top: 10%" >
        <img id="imageAddress" src="" alt="TSLA" height="100%"/>
    </div>

    <div id="stockInfo" align="center">
        <h1 style="color: crimson;" >TSLA</h1>

        <p style="color: white">현재가 : <b id="price"></b> </p>
        <p style="color: white"> 전일대비 : <b id="change"></b> ( <b id="percent"></b> )  </p>

    </div>
</div>
</body>
</html>

<script>
    var price;
    var change;
    var percent;
    $(document).ready(function () {
        $.ajax({
            type: 'GET',
            url: '/stock',
            success: function (result) {

                price=result.price;
                change=result.change;
                percent=result.percent;
                var color="red";
                if(change>0)
                    color="green";

                $("#price").html(price+"$");
                $("#change").css("color",color).html(change+"$");
                $("#percent").css("color",color).html(percent+"%");
            }
        })
        setInterval(function () {
            $.ajax({
                type: 'GET',
                url: '/stock',
                success: function (result) {

                    price=result.price;
                    change=result.change;
                    percent=result.percent;
                    var color="red";
                    if(change>0)
                        color="green";

                    $("#price").html(price+"$");
                    $("#change").css("color",color).html(change+"$");
                    $("#percent").css("color",color).html(percent+"%");
                }
            })
        }, 5000);
        setInterval(function () {
            $.ajax({
                type: 'GET',
                url: '/image/'+percent,
                success: function (result) {
                    $("#imageAddress").attr("src",result);
                }
            })
        }, 3000);
    });
</script>